<style>
  /* Fundo degrad√™ */
  .sidebar.sidebar-dark {
    background: linear-gradient(135deg, #317a6cff 0%, #44A08D 100%) !important;
  }

  .nav-group-sub .nav-link,
  .nav-group-sub .nav-link i {
    color: #fff !important;
  }

  .nav-group-sub .nav-link:hover {
    background-color: rgba(255, 255, 255, 0.1);
  }

  .nav-sidebar .nav-link i {
    margin-right: 8px;
  }

  .nav-link {
    transition: background-color 0.2s ease, color 0.2s ease;
  }

  #sidebar-search-input {
    background-color: rgba(255, 255, 255, 0.15);
    border: none;
    color: #fff;
  }

  #sidebar-search-input::placeholder {
    color: rgba(255, 255, 255, 0.8);
  }

  .form-control-feedback-icon {
    color: rgba(255, 255, 255, 0.8);
  }
  .nav-item-header {
  padding: 8px 16px;
  font-size: 0.75rem;
  text-transform: uppercase;
  opacity: 0.7;
  color: #fff;
  }
</style>
<div class="sidebar sidebar-dark sidebar-main sidebar-expand-xl">
  <div class="sidebar-content">
    <!-- üîç Busca -->
    <div class="sidebar-section-body p-2">
      <div class="form-control-feedback form-control-feedback-end">
        <input
          type="search"
          id="sidebar-search-input"
          class="form-control"
          placeholder="Pesquisar"
          onkeyup="filterSidebar()"
        >
          <div class="form-control-feedback-icon">
            <i class="ph-magnifying-glass opacity-50"></i>
          </div>
        </div>
      </div>
      <div class="sidebar-section">
        <ul class="nav nav-sidebar pv-nav" data-nav-type="accordion" id="sidebar-items">
          <li class="nav-item">
            <%= link_to root_path, class: "nav-link" do %>
              <i class="ph-house"></i>
              <span>Home</span>
            <% end %>
          </li>
          <li class="nav-item-header">Administrativo</li>
          <li class="nav-item">
            <%= link_to users_path, class: "nav-link" do %>
              <i class="ph-users"></i>
              <span>Usu√°rios</span>
            <% end %>
          </li>
          <li class="nav-item">
            <%= link_to a_empresas_prestadores_path, class: "nav-link" do %>
              <i class="ph-storefront"></i>
              <span>Empresas Prestadoras</span>
            <% end %>
          </li>
          <li class="nav-item">
            <%= link_to c_condominios_path, class: "nav-link" do %>
              <i class="ph-buildings"></i>
              <span>Condom√≠nios</span>
            <% end %>
          </li>
          <!-- ================= OPERA√á√ïES ================= -->
          <li class="nav-item-header">Opera√ß√µes</li>
          <li class="nav-item">
            <%= link_to o_ordem_servicos_path, class: "nav-link" do %><i class="ph-file-text"></i><span>Ordens de Servi√ßo</span>
            <% end %>
          </li>
          <li class="nav-item">
            <%= link_to t_taxas_path, class: "nav-link" do %>
              <i class="ph-percent"></i>
              <span>Taxas</span>
            <% end %>
          </li>
          <li class="nav-item nav-item-submenu">
            <a href="#" class="nav-link">
              <i class="ph-credit-card"></i>
              <span>Cart√µes</span>
            </a>
            <ul class="nav-group-sub collapse">
              <li class="nav-item"><%= link_to "Cart√µes", c_cartoes_path, class: "nav-link" %></li>
              <li class="nav-item"><%= link_to "Tipos de Cart√£o", c_tipo_cartoes_path, class: "nav-link" %></li>
              <li class="nav-item"><%= link_to "N√≠veis de Cart√£o", c_nivel_cartoes_path, class: "nav-link" %></li>
            </ul>
          </li>
          <!-- ================= CONFIGURA√á√ïES ================= -->
          <li class="nav-item-header">Configura√ß√µes</li>
          <li class="nav-item nav-item-submenu">
            <a href="#" class="nav-link">
              <i class="ph-database"></i>
              <span>Tabelas Referenciais</span>
            </a>
            <ul class="nav-group-sub collapse">
              <!-- üîπ USU√ÅRIOS -->
              <li class="nav-item nav-item-submenu">
                <a href="#" class="nav-link">
                  <i class="ph-users"></i>
                  <span>Usu√°rios</span>
                </a>
                <ul class="nav-group-sub">
                  <li><%= link_to "Tipos de Usu√°rio", a_tipo_usuarios_path, class: "nav-link" %></li>
                  <li><%= link_to "Status Administrativo", a_status_index_path, class: "nav-link" %></li>
                </ul>
              </li>
              <!-- üîπ OPERA√á√ïES (MOVIDO PRA REFERENCIAIS) -->
              <li class="nav-item nav-item-submenu">
                <a href="#" class="nav-link">
                  <i class="ph-briefcase"></i>
                  <span>Opera√ß√µes</span>
                </a>
                <ul class="nav-group-sub">
                  <li><%= link_to "Tipos de Solicita√ß√£o", o_tipos_solicitacoes_path, class: "nav-link" %></li>
                  <li><%= link_to "Categorias de Servi√ßos", o_categorias_servicos_path, class: "nav-link" %></li>
                  <li><%= link_to "Urg√™ncias", o_urgencias_path, class: "nav-link" %></li>
                  <li><%= link_to "Status de Solicita√ß√µes", o_status_index_path, class: "nav-link" %></li>
                </ul>
              </li>
              <!-- üîπ LOCALIDADES -->
              <li class="nav-item nav-item-submenu">
                <a href="#" class="nav-link">
                  <i class="ph-map-pin-line"></i>
                  <span>Localidades</span>
                </a>
                <ul class="nav-group-sub">
                  <li><%= link_to "Pa√≠ses", g_paises_path, class: "nav-link" %></li>
                  <li><%= link_to "Estados", g_estados_path, class: "nav-link" %></li>
                  <li><%= link_to "Munic√≠pios", g_municipios_path, class: "nav-link" %></li>
                  <li><%= link_to "Distritos", g_distritos_path, class: "nav-link" %></li>
                  <li><%= link_to "Bairros", g_bairros_path, class: "nav-link" %></li>
                  <li><%= link_to "Localidades", g_localidades_path, class: "nav-link" %></li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <script>
    function filterSidebar() {
      const filter = document.getElementById("sidebar-search-input").value.toLowerCase().trim();
      const items = document.querySelectorAll("#sidebar-items > li");

      items.forEach(item => {
        const text = item.textContent.toLowerCase();
        const submenu = item.querySelector(".nav-group-sub");

        if (!filter) {
          item.style.display = "";
          if (submenu) submenu.classList.remove("show");
          return;
        }

        if (submenu) {
          let match = false;
          submenu.querySelectorAll("li.nav-item").forEach(sub => {
            const ok = sub.textContent.toLowerCase().includes(filter);
            sub.style.display = ok ? "" : "none";
            if (ok) match = true;
          });

          if (match || text.includes(filter)) {
            item.style.display = "";
            submenu.classList.add("show");
          } else {
            item.style.display = "none";
          }
        } else {
          item.style.display = text.includes(filter) ? "" : "none";
        }
      });
    }
  </script>
