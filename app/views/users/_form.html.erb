<%= simple_form_for(@user) do |f| %>
  <div class="card shadow-sm border-0">
    <div class="card-header bg-light d-flex justify-content-between align-items-center">
      <h5 class="mb-0">
        <%= @user.new_record? ? "Novo Usu√°rio" : "Editar Usu√°rio" %>
      </h5>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <!-- Nome -->
        <div class="col-md-6">
          <%= f.input :nome, placeholder: "Nome completo", input_html: { class: "form-control" } %>
        </div>
        <!-- Email -->
        <div class="col-md-6">
          <%= f.input :email, placeholder: "email@exemplo.com", input_html: { class: "form-control" } %>
        </div>
        <!-- Telefone -->
        <div class="col-md-6">
          <%= f.input :telefone, placeholder: "(00) 00000-0000", input_html: { class: "form-control telefone" } %>
        </div>
        <!-- Tipo de Usu√°rio -->
        <div class="col-md-6">
          <%= f.input :a_tipo_usuario_id,
                      collection: ATipoUsuario.all,
                      label_method: :descricao,
                      value_method: :id,
                      prompt: "Selecione o tipo de usu√°rio",
                      input_html: { id: "tipo-usuario-select", class: "form-select" } %>
        </div>
        <!-- Condom√≠nio (Somente para S√≠ndico) -->
        <div class="col-md-6" id="campo-condominio">
          <%= f.input :c_condominio_id,
                      collection: CCondominio.all,
                      label_method: :nome,
                      value_method: :id,
                      prompt: "Selecione o Condom√≠nio",
                      input_html: { class: "form-select" } %>
        </div>
        <!-- Empresa Prestadora (Somente para Prestador) -->
        <div class="col-md-6" id="campo-empresa-prestadora">
          <%= f.input :a_empresa_prestador_id,
                      collection: AEmpresaPrestador.all,
                      label_method: :nome_fantasia,
                      value_method: :id,
                      prompt: "Selecione a Empresa Prestadora",
                      input_html: { class: "form-select" } %>
        </div>
        <!-- Senha -->
        <div class="col-md-6">
          <%= f.input :password,
                      placeholder: "Senha (deixe em branco para manter a atual)",
                      input_html: { autocomplete: "new-password", class: "form-control" } %>
        </div>
        <!-- Confirmar Senha -->
        <div class="col-md-6">
          <%= f.input :password_confirmation,
                      placeholder: "Confirme a senha",
                      input_html: { autocomplete: "new-password", class: "form-control" } %>
        </div>
      </div>
    </div>
    <div class="card-footer d-flex justify-content-between bg-light">
      <%= link_to "‚Ü©Ô∏è Voltar", users_path, class: "btn btn-outline-secondary" %>
      <%= f.button :submit, "üíæ Salvar", class: "btn btn-success" %>
    </div>
  </div>
<% end %>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const selectTipo = document.getElementById("tipo-usuario-select");
    const campoCondominio = document.getElementById("campo-condominio");
    const campoPrestadora = document.getElementById("campo-empresa-prestadora");

    function toggleFields() {
      if (!selectTipo) return;

      const text = selectTipo.options[selectTipo.selectedIndex].text.toLowerCase();

      // Tipos esperados ‚Äî ajuste caso seus tipos sejam diferentes
      const isSindico = text.includes("s√≠ndico") || text.includes("sindico");
      const isPrestador = text.includes("prestador");

      campoCondominio.style.display = isSindico ? "block" : "none";
      campoPrestadora.style.display = isPrestador ? "block" : "none";
    }

    selectTipo.addEventListener("change", toggleFields);
    toggleFields(); // roda ao abrir a p√°gina
  });
</script>
